<div class="form-container">
  <h2 class="form-title">{{ isEditMode ? 'Update Customer' : 'Customer Registration' }}</h2>
  <div *ngIf="serverMessage" class="server-error-banner">{{ serverMessage }}</div>
  <form [formGroup]="customerForm" (ngSubmit)="onSubmit()">
    <div class="form-row">
      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>First Name</mat-label>
          <input matInput formControlName="firstName" maxlength="50" />
          <mat-error *ngIf="customerForm.get('firstName')?.hasError('required')">First name is required</mat-error>
          <mat-error *ngIf="customerForm.get('firstName')?.hasError('pattern')">First name contains invalid characters</mat-error>
          <mat-error *ngIf="customerForm.get('firstName')?.hasError('serverError')">{{customerForm.get('firstName')?.getError('serverError') }}</mat-error>
        </mat-form-field>
      </div>
      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>Last Name</mat-label>
          <input matInput formControlName="lastName" maxlength="50" />
          <mat-error *ngIf="customerForm.get('lastName')?.hasError('required')">Last name is required</mat-error>
          <mat-error *ngIf="customerForm.get('lastName')?.hasError('pattern')">Last name contains invalid characters</mat-error>
          <mat-error *ngIf="customerForm.get('lastName')?.hasError('serverError')">{{customerForm.get('lastName')?.getError('serverError') }}</mat-error>
        </mat-form-field>
      </div>
    </div>
    <div class="form-row">
      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>Date Of Birth</mat-label>
          <input matInput formControlName="dateOfBirth" [matDatepicker]="picker" [max]="maxDate" readonly />
          <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
          <mat-error *ngIf="customerForm.get('dateOfBirth')?.invalid">Date of Birth is required</mat-error>
          <mat-error *ngIf="customerForm.get('dateOfBirth')?.hasError('serverError')">{{customerForm.get('dateOfBirth')?.getError('serverError') }}</mat-error>
        </mat-form-field>
      </div>
      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>Mobile Number</mat-label>
          <input matInput type="tel" formControlName="mobile" maxlength="10" />
          <mat-error *ngIf="customerForm.get('mobile')?.hasError('required')">Mobile number is required</mat-error>
          <mat-error *ngIf="customerForm.get('mobile')?.hasError('pattern')">Enter valid 10 digit mobile number</mat-error>
          <mat-error *ngIf="customerForm.get('mobile')?.hasError('serverError')">{{customerForm.get('mobile')?.getError('serverError') }}</mat-error>
        </mat-form-field>
      </div>
    </div>
    <div class="form-row">
      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>Email Address</mat-label>
          <input matInput formControlName="email" maxlength="150" />
          <mat-error *ngIf="customerForm.get('email')?.hasError('required')">Email is required</mat-error>
          <mat-error *ngIf="customerForm.get('email')?.hasError('pattern')">Email format is invalid</mat-error>
          <mat-error *ngIf="customerForm.get('email')?.hasError('serverError')">{{customerForm.get('email')?.getError('serverError') }}</mat-error>
        </mat-form-field>
      </div>
      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>Age</mat-label>
          <input matInput type="number" formControlName="age" min="0" />
          <mat-error *ngIf="customerForm.get('age')?.invalid">Age is required</mat-error>
          <mat-error *ngIf="customerForm.get('age')?.hasError('serverError')">{{customerForm.get('age')?.getError('serverError') }}</mat-error>
        </mat-form-field>
      </div>
    </div>
    <div class="form-row">
      <div class="form-group full-width">
        <label>Gender</label>
        <mat-radio-group formControlName="gender" class="radio-group">
          <mat-radio-button value="MALE">Male</mat-radio-button>
          <mat-radio-button value="FEMALE">Female</mat-radio-button>
          <mat-radio-button value="OTHER">Other</mat-radio-button>
        </mat-radio-group>
        <span *ngIf="customerForm.get('gender')?.hasError('serverError')" class="field-error">{{customerForm.get('gender')?.getError('serverError') }}</span>
      </div>
    </div>
    <div class="form-row">
      <div class="form-group full-width">
        <mat-form-field appearance="outline">
          <mat-label>Address Line 1</mat-label>
          <textarea matInput formControlName="address1" maxlength="255"></textarea>
          <mat-error *ngIf="customerForm.get('address1')?.hasError('required')">Address Line 1 is required</mat-error>
          <mat-error *ngIf="customerForm.get('address1')?.hasError('pattern')">Address Line 1 contains invalid characters</mat-error>
          <mat-error *ngIf="customerForm.get('address1')?.hasError('serverError')">{{customerForm.get('address1')?.getError('serverError') }}</mat-error>
        </mat-form-field>
      </div>
    </div>
    <div class="form-row">
      <div class="form-group full-width">
        <mat-form-field appearance="outline">
          <mat-label>Address Line 2</mat-label>
          <textarea matInput formControlName="address2" maxlength="255"></textarea>
          <mat-error *ngIf="customerForm.get('address2')?.hasError('pattern')">Address Line 2 contains invalid characters</mat-error>
          <mat-error *ngIf="customerForm.get('address2')?.hasError('serverError')">{{customerForm.get('address2')?.getError('serverError') }}</mat-error>
        </mat-form-field>
      </div>
    </div>
    <div class="form-actions">
      <button type="submit" mat-raised-button color="primary" [disabled]="customerForm.invalid">
        {{ isEditMode ? 'Update Customer' : 'Save Customer' }}
      </button>
      <button *ngIf="!isEditMode" type="button" mat-raised-button (click)="clear()">Clear</button>
    </div>
  </form>
</div>